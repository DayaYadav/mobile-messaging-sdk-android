plugins {
    id 'java'
    id 'com.github.johnrengelman.shadow' version '1.2.3'
    id "nebula.provided-base" version "2.2.2"
    id "nebula.optional-base" version "2.2.2"
    id 'idea'
}

group 'org.infobip.mobile.messaging.api'
version '1.0.0-SNAPSHOT'


jar {
    classifier = 'non_shaded'
}

jar.dependsOn(shadowJar)

shadowJar {
    classifier = ''
    zip64 = true
    relocate 'com.google.gson', 'org.infobip.mobile.messaging.api.shaded.google.gson'
    manifest {
        attributes("Implementation-Title": "Gradle", "Implementation-Version": version)
    }
}

artifacts {
    shadowJar
}

idea {
    module {
        try {
            scopes.PROVIDED.plus += [project.configurations.provided]

            //scopes.PROVIDED.plus += project.configurations.provided.compile
            //scopes.PROVIDED.plus += project.configurations.provided.runtime
            //scopes.COMPILE.minus += project.configurations.provided.compile
            //scopes.RUNTIME.minus += project.configurations.provided.runtime
        } catch(NullPointerException e) {
            println ":${project.name} ${e}"
        }
    }
}

dependencies {
    compile group: 'com.google.code.gson', name: 'gson', version: '2.6.2'

    provided group: 'org.projectlombok', name: 'lombok', version: '1.16.8'

    testCompile group: 'junit', name: 'junit', version: '4.11'
    testCompile group: 'org.assertj', name: 'assertj-core', version: '2.3.0'
    testCompile group: 'com.nanohttpd', name: 'nanohttpd', version: '2.1.0'
}
